<mah:MetroWindow
    x:Class="ZPrinterConfig.Views.MainWindowView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Convert="clr-namespace:ZPrinterConfig.Converters"
    xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
    xmlns:IconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ed="http://schemas.microsoft.com/expression/2010/drawing"
    xmlns:local="clr-namespace:ZPrinterConfig.ViewModels"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Dialog:DialogParticipation.Register="{Binding}"
    d:DataContext="{d:DesignInstance Type=local:MainWindowViewModel}"
    PreviewKeyDown="MetroWindow_PreviewKeyDown"
    ResizeMode="NoResize"
    SizeToContent="WidthAndHeight"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <mah:MetroWindow.DataContext>
        <local:MainWindowViewModel />
    </mah:MetroWindow.DataContext>

    <mah:MetroWindow.Resources>
        <Convert:RecommendedValueToVisibility x:Key="recommendedValueToVisibility" />
    </mah:MetroWindow.Resources>

    <mah:MetroWindow.Title>
        <MultiBinding StringFormat="ZPrinterConfig : {0}">
            <Binding Path="Version" />
        </MultiBinding>
    </mah:MetroWindow.Title>

    <mah:MetroWindow.RightWindowCommands>
        <mah:WindowCommands>
            >
            <!--<Button BorderThickness="0"
                        x:Name="btnColorBlind"
                        Click="btnColorBlind_Click">
                <IconPacks:PackIconModern Width="20" Height="20" Kind="Eye"/>
            </Button>-->

            <Button
                x:Name="btnLightTheme"
                BorderThickness="0"
                Click="btnLightTheme_Click">
                <IconPacks:PackIconModern
                    Width="20"
                    Height="20"
                    Kind="WeatherSun" />
            </Button>

            <Button
                x:Name="btnDarkTheme"
                BorderThickness="0"
                Click="btnDarkTheme_Click">
                <IconPacks:PackIconModern
                    Width="20"
                    Height="20"
                    Kind="MoonWaningCrescent" />
            </Button>
        </mah:WindowCommands>
    </mah:MetroWindow.RightWindowCommands>


    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <Border
            Grid.Row="0"
            Margin="3"
            BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
            BorderThickness="1">
            <StackPanel
                Margin="3"
                HorizontalAlignment="Left"
                Orientation="Horizontal">

                <Label Margin="3" Content="Printer Connection Details" />

                <TextBox
                    MinWidth="80"
                    Margin="3"
                    mah:TextBoxHelper.Watermark="Printer IP / Host"
                    Text="{Binding Host}" />

                <TextBox
                    MinWidth="80"
                    Margin="3,3,0,3"
                    mah:TextBoxHelper.Watermark="Port"
                    Text="{Binding Port}" />

                <Button
                    Name="btnResetPortNumber"
                    Grid.Column="1"
                    Margin="0,3"
                    Click="btnResetPortNumber_Click"
                    ToolTip="Reset port number.">
                    <IconPacks:PackIconRadixIcons Kind="Reset" />
                </Button>

                <Label Margin="3" Content="{Binding SocketStatus}" />

            </StackPanel>
        </Border>

        <Border
            Grid.Row="1"
            Margin="3"
            BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
            BorderThickness="1">
            <StackPanel
                Margin="3"
                HorizontalAlignment="Left"
                Orientation="Horizontal">
                <Label Margin="3" Content="Select a Label Type: " />
                <ComboBox
                    MinWidth="100"
                    Margin="3"
                    ItemsSource="{Binding BVOperationTypes}"
                    SelectedValue="{Binding BVSelectedOperationType}" />
            </StackPanel>
        </Border>

        <Border
            Grid.Row="2"
            Margin="3"
            BorderBrush="{DynamicResource MahApps.Brushes.Accent}"
            BorderThickness="1">

            <DataGrid
                x:Name="dgBVParameters"
                Margin="3"
                AutoGenerateColumns="False"
                CanUserAddRows="False"
                CanUserSortColumns="False"
                ItemsSource="{Binding BVSettings}"
                SelectionChanged="DataGrid_SelectionChanged">
                <DataGrid.Columns>

                    <DataGridTemplateColumn Header="Parameter Name">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Label Content="{Binding Name, Mode=OneWay}" ToolTip="{Binding Description}" />
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="Parameter Path">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Label ToolTip="{Binding Description}">
                                        <TextBlock Text="{Binding ParameterName, Mode=OneWay}" />
                                    </Label>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn Binding="{Binding Options, Mode=OneWay}" Header="Options" />

                    <DataGridTextColumn Binding="{Binding Default, Mode=OneWay}" Header="Default">
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>

                    <DataGridTextColumn Binding="{Binding Recommended, Mode=OneWay}" Header="Recommended">
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="TextBlock.TextAlignment" Value="Right" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                            </Style>
                        </DataGridTextColumn.CellStyle>
                    </DataGridTextColumn>

                    <DataGridTemplateColumn>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>

                                    <Button
                                        Grid.Column="1"
                                        Margin="3"
                                        Command="{Binding Path=DataContext.CopyRecommendedCommand, RelativeSource={RelativeSource AncestorType=mah:MetroWindow}}"
                                        CommandParameter="{Binding}"
                                        Visibility="{Binding Path=DataContext.Recommended, RelativeSource={RelativeSource AncestorType=DataGridRow}, Converter={StaticResource recommendedValueToVisibility}}">
                                        <IconPacks:Unicons
                                            Width="8"
                                            Height="8"
                                            Kind="AngleDoubleRightThinline" />
                                    </Button>

                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="Write Value">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBox Text="{Binding WriteValue}" TextChanged="TextBox_TextChanged" />
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Button
                                        Grid.Column="1"
                                        Margin="3"
                                        Command="{Binding Path=DataContext.WriteCommand, RelativeSource={RelativeSource AncestorType=mah:MetroWindow}}"
                                        CommandParameter="{Binding}">
                                        <IconPacks:Unicons
                                            Width="20"
                                            Height="20"
                                            Kind="EditAlt" />
                                    </Button>
                                </Grid>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!--  The parameter value  -->
                    <DataGridTextColumn Binding="{Binding ReadValue}">
                        <DataGridTextColumn.Header>
                            <Button Command="{Binding Path=DataContext.ReadAllCommand, RelativeSource={RelativeSource AncestorType=mah:MetroWindow}}" Content="Read All" />
                        </DataGridTextColumn.Header>
                        <DataGridTextColumn.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="TextBlock.TextAlignment" Value="Center" />
                                <Setter Property="TextBlock.VerticalAlignment" Value="Center" />
                            </Style>
                        </DataGridTextColumn.CellStyle>

                    </DataGridTextColumn>

                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <StatusBar Grid.Row="4" Margin="3">
            <StatusBarItem>
                <TextBlock Text="Status: " />
            </StatusBarItem>

            <StatusBarItem>
                <TextBlock Text="{Binding Status}" />
            </StatusBarItem>
        </StatusBar>

    </Grid>

</mah:MetroWindow>
